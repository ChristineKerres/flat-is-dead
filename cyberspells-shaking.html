<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shake Detection</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        text-align: center;
        font-family: Arial, sans-serif;
      }
      button {
        padding: 10px 20px;
        font-size: 18px;
        margin-top: 20px;
        cursor: pointer;
      }
      #message {
        font-size: 20px;
        margin-top: 20px;
        font-weight: bold;
        color: green;
      }
      #dataDisplay {
        margin-top: 20px;
        font-size: 16px;
        color: blue;
        font-family: monospace;
      }
    </style>
  </head>
  <body>
    <h1>Shake Your Phone!</h1>
    <p id="instruction">Click the button to start shake detection.</p>
    <button id="startShake">Start Shake Detection</button>
    <p id="message"></p>
    <div id="dataDisplay">
      <p><strong>Accelerometer Data:</strong></p>
      <p>X: <span id="xValue">0</span></p>
      <p>Y: <span id="yValue">0</span></p>
      <p>Z: <span id="zValue">0</span></p>
      <p><strong>Delta Values:</strong></p>
      <p>Delta X: <span id="deltaX">0</span></p>
      <p>Delta Y: <span id="deltaY">0</span></p>
      <p>Delta Z: <span id="deltaZ">0</span></p>
    </div>

    <script>
      let lastX, lastY, lastZ;
      let shakeThreshold = 15; // Adjust threshold for detecting shakes
      let isShaking = false;

      // Function to start shake detection
      function startShakeDetection() {
        document.getElementById("instruction").innerText =
          "Shake your device to trigger the event!";
        
        // Start monitoring the device motion
        window.addEventListener("devicemotion", handleDeviceMotion);
      }

      // Function to handle the device motion event
      function handleDeviceMotion(event) {
        // Get the device's accelerometer data (Acceleration along X, Y, Z axes)
        const acceleration = event.accelerationIncludingGravity;

        // Update accelerometer data on the page
        document.getElementById("xValue").innerText = acceleration.x.toFixed(2);
        document.getElementById("yValue").innerText = acceleration.y.toFixed(2);
        document.getElementById("zValue").innerText = acceleration.z.toFixed(2);

        // If the event data is not available, log a warning
        if (!acceleration) {
          console.warn('No accelerometer data available.');
          return;
        }

        const currentX = acceleration.x;
        const currentY = acceleration.y;
        const currentZ = acceleration.z;

        if (lastX && lastY && lastZ) {
          const deltaX = Math.abs(currentX - lastX);
          const deltaY = Math.abs(currentY - lastY);
          const deltaZ = Math.abs(currentZ - lastZ);

          // Update delta values on the page
          document.getElementById("deltaX").innerText = deltaX.toFixed(2);
          document.getElementById("deltaY").innerText = deltaY.toFixed(2);
          document.getElementById("deltaZ").innerText = deltaZ.toFixed(2);

          // If the change is above the threshold, consider it a shake
          if (deltaX > shakeThreshold || deltaY > shakeThreshold || deltaZ > shakeThreshold) {
            if (!isShaking) {
              isShaking = true;
              document.getElementById("message").innerText = "Shake detected!";
              document.getElementById("message").style.color = "red"; // Change color to indicate shake
            }
          } else {
            isShaking = false;
          }
        }

        // Update the last known values
        lastX = currentX;
        lastY = currentY;
        lastZ = currentZ;
      }

      // Event listener for the button to enable shake detection
      document.getElementById("startShake").addEventListener("click", startShakeDetection);
    </script>
  </body>
</html>
